{"version":3,"sources":["index.js"],"names":["isMobile","$","window","width","controller","ScrollMagic","Controller","nowHour","Date","getHours","outdoorIndex","rangeInput","document","querySelectorAll","currentAge","retireAge","lifeSpan","totalAssets","salary","incomeReplacementRatio","inflation","totalInvest","insuranceVal","requiredAmount","getElementById","shortage","rspResult","PMT","ir","np","pv","fv","type","pmt","pvif","Math","pow","calcRequiredAmount","requiredAmountVal","ceil","innerHTML","formatValWithCommas","calcPresentInsuranceValue","rate","nper","round","conv_number","expr","decplaces","str","eval","length","decpoint","substring","parseFloat","alert","pv_value","x","y","calcCurrentDepositAssets","floor","calcShortage","currentDepositAssets","presentValueOfInsurance","shortageVal","calcPMT","pmtV","val","toString","replace","checkIfLimit","value","progressName","maxV","concat","slider","minV","limit","max","min","calcValForRangeSlider","verifyPhone","phone","test","verifyId","id","checkWid","windowSize","mobileFun","desktopFun","prodcutOwl","owlCarousel","nav","dots","responsive","0","loop","items","onInitialize","event","addClass","onChanged","page","index","text","removeClass","on","trigger","off","setCarousel","autoplay","769","margin","1280","infoOwl","center","autoHeight","fadeIn","fadeOut","setSlider","arguments","undefined","v","s","setVariable","range","step","slide","ui","change","this","setAnimate","TweenMax","set","opacity","doAnimate","TimelineMax","add","to","delay","triggerElement","offset","reverse","staggerTo","tween","Scene","indicator","setTween","addTo","resize","ready","show","hide","closest","is","ajax","url","data","name","isPcalife","identityNumber","success","res","error","err"],"mappings":"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","file":"all.js","sourcesContent":["let isMobile = $(window).width() > 768;\nlet controller = new ScrollMagic.Controller();\nlet nowHour = new Date().getHours();\nlet outdoorIndex = 0;\n\n//-- range slider part\nlet rangeInput = document.querySelectorAll(\".amount-input\");\nlet currentAge = 35,\n  retireAge = 65,\n  lifeSpan = 75,\n  totalAssets = 500000,\n  salary = 46000,\n  incomeReplacementRatio = 70,\n  inflation = 5,\n  totalInvest = 2;\nlet insuranceVal = 17120;\n\nlet requiredAmount = document.getElementById(\"requiredAmount\");\nlet shortage = document.getElementById(\"shortage\");\nlet rspResult = document.getElementById(\"rspResult\");\n\nfunction PMT(ir, np, pv, fv, type) {\n  /*\n   * ir   - interest rate per month\n   * np   - number of periods (months)\n   * pv   - present value\n   * fv   - future value\n   * type - when the payments are due:\n   *        0: end of the period, e.g. end of month (default)\n   *        1: beginning of period\n   */\n  var pmt, pvif;\n  fv || (fv = 0);\n  type || (type = 0);\n\n  if (ir === 0) return -(pv + fv) / np;\n\n  pvif = Math.pow(1 + ir, np);\n  pmt = (-ir * (pv * pvif + fv)) / (pvif - 1);\n\n  if (type === 1) pmt /= 1 + ir;\n\n  console.log(\"pmt in function:\" + pmt);\n  return pmt;\n}\n\nfunction calcRequiredAmount() {\n  var requiredAmountVal = Math.ceil(\n    salary * (incomeReplacementRatio / 100) * (lifeSpan - retireAge) * 12\n  );\n  requiredAmount.innerHTML = formatValWithCommas(requiredAmountVal);\n  return requiredAmountVal;\n}\n\n// calc present insurance value\nfunction calcPresentInsuranceValue(rate, nper, pmt) {\n  rate = rate / 12 / 100;\n  if (rate === 0 || !rate) {\n    return false;\n  } else {\n    var val = Math.round((-pmt * (1 - 1 / Math.pow(1 + rate, nper))) / rate);\n    return val;\n  }\n}\n\n// This function is from David Goodman's Javascript Bible.\nfunction conv_number(expr, decplaces) {\n  var str = \"\" + Math.round(eval(expr) * Math.pow(10, decplaces));\n  while (str.length <= decplaces) {\n    str = \"0\" + str;\n  }\n\n  var decpoint = str.length - decplaces;\n  return str.substring(0, decpoint) + \".\" + str.substring(decpoint, str.length);\n}\n// Parameters are rate, total number of periods, payment made each period and future value\nfunction pv(rate, nper, pmt, fv) {\n  rate = parseFloat(rate);\n  nper = parseFloat(nper);\n  pmt = parseFloat(pmt);\n  fv = parseFloat(fv);\n  if (nper == 0) {\n    alert(\"Why do you want to test me with zeros?\");\n    return 0;\n  }\n  if (rate == 0) {\n    // Interest rate is 0\n    pv_value = -(fv + pmt * nper);\n  } else {\n    x = Math.pow(1 + rate, -nper);\n    y = Math.pow(1 + rate, nper);\n    pv_value = -(x * (fv * rate - pmt + y * pmt)) / rate;\n  }\n  pv_value = conv_number(pv_value, 2);\n  return pv_value;\n}\n\n//--------\n\n//calc total deposit assets 計算活儲資產\nfunction calcCurrentDepositAssets(totalAssets, retireAge, currentAge) {\n  totalAssets = Math.floor(totalAssets);\n  // var periods = retireAge - currentAge;\n  return Math.round(totalAssets * Math.pow(1.01, retireAge - currentAge));\n}\n\nfunction calcShortage() {\n  var requiredAmountVal = calcRequiredAmount();\n  var currentDepositAssets = calcCurrentDepositAssets(\n    totalAssets,\n    retireAge,\n    currentAge\n  );\n  var presentValueOfInsurance = calcPresentInsuranceValue(\n    inflation,\n    (lifeSpan - retireAge) * 12,\n    insuranceVal * -1,\n    0\n  );\n\n  // var ppPV = pv(inflation / 100 / 12, (lifeSpan - retireAge) * 12, insuranceVal * -1, 0);\n\n  var shortageVal =\n    requiredAmountVal - presentValueOfInsurance - currentDepositAssets;\n  console.log(\"currentDepositAssets:\" + currentDepositAssets);\n  console.log(\"presentValueOfInsurance:\" + presentValueOfInsurance);\n\n  // console.log('ppPV:' + ppPV);\n\n  shortage.innerHTML = formatValWithCommas(shortageVal);\n  return shortageVal;\n}\n\nfunction calcPMT() {\n  // alert('call pmt');\n  var shortageVal = calcShortage();\n  var pmtV = Math.floor(\n    PMT(\n      totalInvest / 100 / 12,\n      (retireAge - currentAge) * 12,\n      0,\n      shortageVal * -1,\n      0\n    )\n  );\n  console.log(\"pmtV:\" + pmtV);\n  rspResult.innerHTML = formatValWithCommas(pmtV);\n  return pmtV;\n}\n\nfunction formatValWithCommas(val) {\n  val = val.toString();\n  return val.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n\n// check if input value over max / below min\nfunction checkIfLimit(value, progressName) {\n  var maxV = $(`#progress-${progressName}`).slider(\"option\", \"max\");\n  var minV = $(`#progress-${progressName}`).slider(\"option\", \"min\");\n  // console.log(maxV);\n  if (value > maxV || minV > value) {\n    if (value > maxV) {\n      return { limit: \"more\", max: maxV, min: minV };\n    } else {\n      return { limit: \"less\", max: maxV, min: minV };\n    }\n  } else {\n    return false;\n  }\n}\n\n// check return value for ui slider\nfunction calcValForRangeSlider(value, progressName) {\n  console.log(value);\n  console.log(progressName);\n  var step = $(`#progress-${progressName}`).slider(\"option\", \"step\");\n  console.log(step);\n  $(`#progress-${progressName}`).slider(\"value\", value);\n}\n\n$(window).resize(function () {\n  let windowSize = $(window).width();\n  checkWid(windowSize);\n});\n\nfunction verifyPhone(phone) {\n  const phoneRules = /^09\\d{8}$/;\n  return phoneRules.test(phone);\n}\n\nfunction verifyId(id) {\n  const idRules = /^[A-Z]{1}[1-2]{1}[0-9]{8}$/;\n  return idRules.test(id);\n}\n\nfunction checkWid(windowSize) {\n  if (windowSize < 768 && !isMobile) {\n    isMobile = true;\n    mobileFun();\n  } else if (windowSize > 768 && isMobile) {\n    isMobile = false;\n    desktopFun();\n  }\n}\n\nfunction mobileFun() {\n  let prodcutOwl = $(\"#product-carousel\");\n  prodcutOwl.owlCarousel({\n    nav: false,\n    dots: true,\n    responsive: {\n      0: {\n        loop: false,\n        items: 1,\n      },\n    },\n    onInitialize: (event) => {\n      $(\"#productLeftArrow\").addClass(\"disabled\");\n    },\n    onChanged: (event) => {\n      if (event.page.index < 0) {\n        $(\"#productNowPage\").text(`01`);\n      } else {\n        $(\"#productNowPage\").text(`0${event.page.index + 1}`);\n      }\n      if (event.page.index <= 0) {\n        $(\"#productLeftArrow\").addClass(\"disabled\");\n      } else if (event.page.index == 6) {\n        $(\"#productRightArrow\").addClass(\"disabled\");\n      } else {\n        $(\"#productLeftArrow\").removeClass(\"disabled\");\n        $(\"#productRightArrow\").removeClass(\"disabled\");\n      }\n    },\n  });\n  $(\"#productLeftArrow\").on(\"click\", () => {\n    prodcutOwl.trigger(\"prev.owl.carousel\");\n  });\n  $(\"#productRightArrow\").on(\"click\", () => {\n    prodcutOwl.trigger(\"next.owl.carousel\");\n  });\n}\n\nfunction desktopFun() {\n  $(\"#product-carousel\").trigger(\"destroy.owl.carousel\");\n  $(\"#productLeftArrow\").off(\"click\");\n  $(\"#productRightArrow\").off(\"click\");\n}\n\nfunction setCarousel() {\n  $(\"#carouselBox01\").owlCarousel({\n    nav: false,\n    dots: true,\n    autoplay: true,\n    responsive: {\n      0: {\n        loop: true,\n        items: 1,\n      },\n      769: {\n        loop: false,\n        items: 3,\n        margin: 50,\n      },\n      1280: {\n        margin: 100,\n      },\n    },\n  });\n\n  let infoOwl = $(\"#carouselBox02\").owlCarousel({\n    nav: false,\n    dots: true,\n    loop: false,\n    items: 1,\n    center: true,\n    autoHeight: true,\n    margin: 70,\n    onInitialize: (event) => {\n      $(`.section02 .title1`).fadeIn();\n      $(\"#infoNowPage\").text(`01`);\n      $(\"#infoLeftArrow\").addClass(\"disabled\");\n    },\n    onChanged: (event) => {\n      console.log(event.page.index);\n      if (event.page.index >= 0) {\n        $(\"#infoNowPage\").text(`0${event.page.index + 1}`);\n        $(\".section02 .title\").fadeOut();\n        $(`.section02 .title${event.page.index + 1}`).fadeIn();\n      }\n      if (event.page.index <= 0) {\n        $(\"#infoLeftArrow\").addClass(\"disabled\");\n      } else if (event.page.index == 3) {\n        $(\"#infoRightArrow\").addClass(\"disabled\");\n      } else {\n        $(\"#infoLeftArrow\").removeClass(\"disabled\");\n        $(\"#infoRightArrow\").removeClass(\"disabled\");\n      }\n    },\n  });\n  $(\"#infoLeftArrow\").on(\"click\", () => {\n    infoOwl.trigger(\"prev.owl.carousel\");\n  });\n  $(\"#infoRightArrow\").on(\"click\", () => {\n    infoOwl.trigger(\"next.owl.carousel\");\n  });\n}\n\nfunction setSlider(\n  progressName,\n  min = 0,\n  max = 100,\n  v = 0,\n  s = 1,\n  setVariable\n) {\n  $(`#progress-${progressName}`).slider({\n    range: \"min\",\n    min: min,\n    max: max,\n    value: v,\n    step: s,\n    slide: function (event, ui) {\n      setVariable(ui.value);\n    },\n    change: function (event, ui) {\n      calcRequiredAmount();\n      calcShortage();\n      calcPMT();\n    },\n  });\n  $(`#amount-${progressName}`).on(\"change\", function () {\n    $(`#progress-${progressName}`).slider(\"value\", $(this).val());\n    setVariable($(this).val());\n    calcValForRangeSlider($(this).val(), progressName);\n  });\n}\n\nfunction setAnimate() {\n  TweenMax.set(\n    \".banner .banner-title,.section01 .title,.section01 .pic,.section02 .title img,.section02 .container,.section03 .title img,.section03 .animate-item,.section04 .wrapper,.section05 .title img,.section05 .form-box,.section06 .title img,.section06 .remind,.section06 .box .item\",\n    {\n      opacity: 0,\n      y: 50,\n    }\n  );\n  TweenMax.set(\".banner .banner-slogan,.banner .dog-box\", {\n    opacity: 0,\n  });\n  TweenMax.set(\".banner .dadnmom\", {\n    opacity: 0,\n    x: -100,\n  });\n  TweenMax.set(\".banner .papamama\", {\n    opacity: 0,\n    x: 100,\n  });\n\n  // 進場動畫\n  doAnimate(\n    new TimelineMax()\n      .add(\n        TweenMax.to(\".banner .banner-title\", 0.6, {\n          opacity: 1,\n          y: 0,\n        })\n      )\n      .add(\n        TweenMax.to(\".banner .dadnmom\", 0.6, {\n          opacity: 1,\n          x: 0,\n        })\n      )\n      .add(\n        TweenMax.to(\".banner .papamama\", 0.6, {\n          opacity: 1,\n          x: 0,\n          delay: -0.6,\n        })\n      )\n      .add(\n        TweenMax.to(\".banner .banner-slogan\", 1, {\n          opacity: 1,\n        })\n      )\n      .add(\n        TweenMax.to(\".banner .dog-box\", 0.6, {\n          opacity: 1,\n          delay: 0.1,\n        })\n      ),\n    {\n      triggerElement: \".banner\",\n      offset: 0, //指標位移\n      reverse: false, //動畫重複 default:true\n    },\n    \"banner\"\n  );\n  doAnimate(\n    new TimelineMax()\n      .add(\n        TweenMax.to(\".section01 .title\", 0.6, {\n          opacity: 1,\n          y: 0,\n        })\n      )\n      .add(\n        TweenMax.staggerTo(\n          \".section01 .pic\",\n          0.6,\n          {\n            opacity: 1,\n            y: 0,\n          },\n          0.1\n        )\n      ),\n    {\n      triggerElement: \".section01\",\n      offset: 0, //指標位移\n      reverse: false, //動畫重複 default:true\n    },\n    \"section01\"\n  );\n  doAnimate(\n    new TimelineMax()\n      .add(\n        TweenMax.to(\".section02 .title img\", 0.6, {\n          opacity: 1,\n          y: 0,\n        })\n      )\n      .add(\n        TweenMax.staggerTo(\n          \".section02 .container\",\n          0.6,\n          {\n            opacity: 1,\n            y: 0,\n          },\n          0.1\n        )\n      ),\n    {\n      triggerElement: \".section02\",\n      offset: 0, //指標位移\n      reverse: false, //動畫重複 default:true\n    },\n    \"section02\"\n  );\n  doAnimate(\n    new TimelineMax()\n      .add(\n        TweenMax.to(\".section03 .title img\", 0.6, {\n          opacity: 1,\n          y: 0,\n        })\n      )\n      .add(\n        TweenMax.staggerTo(\n          \".section03 .animate-item\",\n          0.6,\n          {\n            opacity: 1,\n            y: 0,\n          },\n          0.1\n        )\n      ),\n    {\n      triggerElement: \".section03\",\n      offset: 0, //指標位移\n      reverse: false, //動畫重複 default:true\n    },\n    \"section03\"\n  );\n  doAnimate(\n    new TimelineMax().add(\n      TweenMax.to(\".section04 .wrapper\", 0.6, {\n        opacity: 1,\n        y: 0,\n      })\n    ),\n    {\n      triggerElement: \".section04\",\n      offset: 0, //指標位移\n      reverse: false, //動畫重複 default:true\n    },\n    \"section04\"\n  );\n  doAnimate(\n    new TimelineMax()\n      .add(\n        TweenMax.to(\".section05 .title img\", 0.6, {\n          opacity: 1,\n          y: 0,\n        })\n      )\n      .add(\n        TweenMax.to(\".section05 .form-box\", 0.6, {\n          opacity: 1,\n          y: 0,\n        })\n      ),\n    {\n      triggerElement: \".section05\",\n      offset: 0, //指標位移\n      reverse: false, //動畫重複 default:true\n    },\n    \"section05\"\n  );\n  doAnimate(\n    new TimelineMax()\n      .add(\n        TweenMax.to(\".section06 .title img\", 0.6, {\n          opacity: 1,\n          y: 0,\n        })\n      )\n      .add(\n        TweenMax.to(\".section06 .remind\", 0.6, {\n          opacity: 1,\n          y: 0,\n        })\n      )\n      .add(\n        TweenMax.staggerTo(\n          \".section06 .box .item\",\n          0.6,\n          {\n            opacity: 1,\n            y: 0,\n          },\n          0.1\n        )\n      ),\n    {\n      triggerElement: \".section06\",\n      offset: 0, //指標位移\n      reverse: false, //動畫重複 default:true\n    },\n    \"section06\"\n  );\n}\n\nfunction doAnimate(tween, Scene, indicator) {\n  return (\n    new ScrollMagic.Scene(Scene)\n      .setTween(tween)\n      // .addIndicators({ name: indicator }) // 指標顯示\n      .addTo(controller)\n  );\n}\n\n$(document).ready(function () {\n  checkWid($(window).width());\n  setCarousel();\n  setAnimate();\n  if (nowHour >= 6 && nowHour < 14) {\n    outdoorIndex = 0;\n    $(\"#morning\").show();\n  } else if (nowHour >= 14 && nowHour < 19) {\n    outdoorIndex = 1;\n    $(\"#noon\").show();\n  } else {\n    outdoorIndex = 2;\n    $(\"#night\").show();\n  }\n  $(\".dog-box\").on(\"click\", () => {\n    outdoorIndex = (outdoorIndex + 4) % 3;\n    $(`.outdoor div`).hide();\n    $(`.outdoor div:nth-child(${outdoorIndex + 1})`).show();\n  });\n\n  setSlider(\"currentAge\", 18, 74, 35, 1, (val) => {\n    $(`#amount-currentAge`).val(val);\n    currentAge = val;\n  });\n  setSlider(\"retireAge\", 50, 75, 65, 1, (val) => {\n    $(`#amount-retireAge`).val(val);\n    retireAge = val;\n  });\n  setSlider(\"lifeSpan\", 66, 99, 75, 1, (val) => {\n    $(`#amount-lifeSpan`).val(val);\n    lifeSpan = val;\n  });\n  setSlider(\"totalAssets\", 0, 3000, 50, 0.1, (val) => {\n    $(`#amount-totalAssets`).val(val);\n    totalAssets = val * 10000;\n  });\n  setSlider(\"salary\", 2.3, 30, 4.6, 0.1, (val) => {\n    $(`#amount-salary`).val(val);\n    salary = val * 10000;\n  });\n  setSlider(\"incomeReplacementRatio\", 10, 100, 70, 1, (val) => {\n    $(`#amount-incomeReplacementRatio`).val(val);\n    incomeReplacementRatio = val;\n  });\n  setSlider(\"inflation\", 0, 5, 5, 1, (val) => {\n    $(`#amount-inflation`).val(val);\n    inflation = val;\n  });\n  setSlider(\"totalInvest\", 0, 10, 2, 1, (val) => {\n    $(`#amount-totalInvest`).val(val);\n    totalInvest = val;\n  });\n\n  calcRequiredAmount();\n  calcShortage();\n  calcPMT();\n\n  $(\"#popupHandler1\").on(\"click\", () => {\n    $(\"#popup1\").fadeIn();\n  });\n  $(\"#popupHandler2\").on(\"click\", () => {\n    $(\"#popup2\").fadeIn();\n  });\n  $(\".close,.mask\").on(\"click\", function () {\n    $(this).closest(\".popup\").fadeOut();\n  });\n\n  $(\"#sendBtn\").on(\"click\", () => {\n    console.log(verifyPhone($(\"#phone\").val()));\n    if (!$(\"#name\").val()) {\n      alert(\"請填寫姓名\");\n      return;\n    } else if (!$(\"#phone\").val() || !verifyPhone($(\"#phone\").val())) {\n      alert(\"請填寫電話及確認格式正確\");\n      return;\n    } else if ($(\"input[name='isPcalife']:checked\").val() == undefined) {\n      alert(\"請確認是否已經是保誠保戶\");\n      return;\n    } else if (\n      $(\"input[name='isPcalife']:checked\").val() == \"1\" &&\n      (!$(\"#identityNumber\").val() || !verifyId($(\"#identityNumber\").val()))\n    ) {\n      alert(\"請輸入身分證字號及確認格式正確\");\n      return;\n    } else if (!$(\"#personalInformation\").is(\":checked\")) {\n      alert(\"請閱讀並同意個人資料告知暨同意事項\");\n      return;\n    } else if (!$(\"#checkBtn\").is(\":checked\")) {\n      alert(\"請確認以上資料正確無誤\");\n      return;\n    }\n    $.ajax({\n      url: \"api/postForm\",\n      type: \"post\",\n      data: {\n        name: $(\"#name\").val(),\n        phone: $(\"#phone\").val(),\n        isPcalife: $(\"input[name='isPcalife']:checked\").val(),\n        identityNumber: $(\"#identityNumber\").val(),\n        currentAge,\n        retireAge,\n        lifeSpan,\n        totalAssets,\n        salary,\n        incomeReplacementRatio,\n        inflation,\n        totalInvest,\n        requiredAmount: calcRequiredAmount(),\n        shortage: calcShortage(),\n        rspResult: calcPMT(),\n      },\n      success: function (res) {\n        console.log(res);\n        alert(\"成功送出資料\");\n      },\n      error: function (err) {\n        console.log(err);\n        alert(\"送出失敗\");\n      },\n    });\n  });\n});\n"]}